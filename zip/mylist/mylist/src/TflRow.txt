#include <Arduino.h>
/// @brief Encapsulate selected data from 1 line in TFL JSON file
class TflRow {
  public:
    TflRow(int at, const char *direction, const char *dest) {
      estArrivTime = at;
      inbound = strcmp(direction,"inbound") == 0;
      destination = dest;
    }
 //   ~TflRow() {
      //Serial.println("Item destroyed"); 
//    }
    int getArriveTime() {
      return estArrivTime; // seconds
    }
    bool getDirection() {
      return inbound;
    }
    const char *getDestination() {
      return destination;
    }
  private:
    int estArrivTime;
    bool inbound;
    const char *destination;
};

#define INCREMENT true // sort in increasing order

/// @brief Utility to compare 2 items by field in class
/// @param l  left item 
/// @param r  right item
/// @return 0 if equal 1 if greater -1 if less

int compare2(const void *l,const void *r) {
  int lv = ((TflRow*)l)->getArriveTime();
  int rv = ((TflRow*)r)->getArriveTime();
  if ( lv == rv)
    return 0;
  else if (INCREMENT)
    return lv > rv ? 1 : -1;
  else
    return lv < rv ? 1 : -1;
}

void printItem(TflRow *pI) {
  Serial.print(pI->getArriveTime());
  Serial.print(":");
  Serial.print(pI->getDirection()? "Inbound" : "Outbound");
  Serial.print(":");
  Serial.println(pI->getDestination());
}
